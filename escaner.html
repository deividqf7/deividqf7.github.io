<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FACAS X - Escáner de Materiales</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(-45deg, #001f3f, #003366, #000, #00f0ff);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
    color: #fff;
    overflow-x: hidden;
    text-align: center;
  }

  @keyframes gradientBG {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  header {
    background: linear-gradient(90deg, #001f3f, #003366);
    padding: 15px;
    font-size: 22px;
    font-weight: bold;
    color: #00f0ff;
    text-align: center;
  }

  .sidebar {
    height: 100%;
    width: 280px;
    position: fixed;
    top: 0;
    left: -290px;
    background-color: #111;
    overflow-x: hidden;
    transition: left 0.5s ease;
    padding-top: 60px;
    z-index: 1000;
  }

  .sidebar.active { left: 0; }
  .sidebar a {
    padding: 12px 24px;
    text-decoration: none;
    font-size: 16px;
    color: #f1f1f1;
    display: block;
    transition: 0.3s;
  }
  .sidebar a:hover { background-color: #004080; }

  .hamburger {
    position: fixed;
    top: 15px;
    left: 15px;
    width: 35px;
    height: 28px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    cursor: pointer;
    z-index: 1100;
  }
  .bar {
    height: 4px;
    width: 100%;
    background-color: white;
    border-radius: 4px;
    transition: 0.4s;
  }
  .hamburger.active .bar:nth-child(1) { transform: rotate(45deg) translate(6px, 6px); }
  .hamburger.active .bar:nth-child(2) { opacity: 0; }
  .hamburger.active .bar:nth-child(3) { transform: rotate(-45deg) translate(6px, -6px); }

  .container {
    max-width: 800px;
    margin: 100px auto;
    padding: 30px;
    background: #001f3f;
    border-radius: 12px;
    border: 2px solid #00f0ff;
    box-shadow: 0 0 25px #00f0ff;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  h2 { color: #00f0ff; margin-bottom: 15px; }

  #button-group {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
  }

  #image-container {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 80%;
    max-width: 400px;
    height: 300px;
    margin: 0 auto 20px auto;
    border: 2px solid #00f0ff;
    border-radius: 12px;
    background-color: #003366; /* color más clarito para destacar la foto */
    overflow: hidden;
  }

  #preview {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: none;
  }

  #cameraPlaceholder {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80px;
    opacity: 0.6;
  }

  #scan-line {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: #00f0ff;
    border-radius: 2px;
    animation: scanAnim 2s linear infinite;
    display: none;
    z-index: 2;
    box-shadow: 0 0 20px #00f0ff;
  }

  @keyframes scanAnim {
    0% { top: 0%; opacity: 1; }
    50% { top: 90%; opacity: 0.6; }
    100% { top: 0%; opacity: 1; }
  }

  #resultado {
    margin-top: 20px;
    padding: 15px;
    background: #001f3f;
    border-radius: 10px;
    border: 1px solid #00f0ff;
    display: none;
    text-align: left;
  }

  .custom-button, #photoButton, #resetButton {
    background: linear-gradient(90deg, #001f3f, #003366);
    color: #00f0ff;
    border: none;
    padding: 12px 0;
    width: 150px;
    margin: 5px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    box-shadow: 0 0 15px #00f0ff;
    transition: 0.3s;
  }

  .custom-button:hover, #photoButton:hover, #resetButton:hover {
    background: linear-gradient(90deg, #00f0ff, #00cfff);
    color: #001f3f;
    box-shadow: 0 0 25px #00f0ff;
  }

  /* ----- NUEVA REGLA: aplica la misma fuente y tamaño al label "Subir Imagen" y al botón "Tomar Foto" ----- */
  .custom-button, #photoButton {
    font-family: Arial, sans-serif;
    font-size: 16px;
  }
  /* ---------------------------------------------------------------------------------------------- */

  footer {
    background-color: #001f3f;
    color: #00f0ff;
    text-align: center;
    padding: 12px;
    margin-top: 40px;
  }
</style>
</head>
<body>

<div class="hamburger" id="hamburger">
  <div class="bar"></div>
  <div class="bar"></div>
  <div class="bar"></div>
</div>

<div id="mySidebar" class="sidebar">
  <a href="#">Nosotros</a>
  <a href="#">Escáner de Materiales</a>
  <a href="#">Proceso del Plástico</a>
  <a href="#">Métodos de Reciclaje</a>
  <a href="#">Tipos de Plásticos</a>
  <a href="#">Características del Material</a>
  <a href="#">Impacto Ambiental</a>
  <a href="#">Formación y Educación Ambiental</a>
  <a href="#">Creaciones con Plástico Reciclado</a>
  <a href="#">Curiosidades y Datos Útiles</a>
  <a href="#">Noticias Ambientales</a>
  <a href="#">Evaluación y Retroalimentación</a>
  <a href="#">Ayuda</a>
</div>

<header>FACAS X - Escáner de Materiales</header>

<div class="container">
  <h2>Escáner de Botellas</h2>
  <p>Sube o toma una foto del código de barras del producto para identificarlo y conocer cómo reciclarlo.</p>

  <div id="button-group">
    <label for="fileInput" class="custom-button">Subir Imagen</label>
    <input type="file" accept="image/*" capture="environment" id="fileInput" style="display:none">
    <button id="photoButton">Tomar Foto</button>
  </div>

  <div id="image-container">
    <img id="preview" alt="Vista previa">
    <img id="cameraPlaceholder" src="https://static.vecteezy.com/system/resources/previews/009/266/389/non_2x/camera-icon-design-free-png.png" alt="Camera placeholder">
    <div id="scan-line"></div>
  </div>

  <div id="resultado"></div>
  <button id="resetButton" style="display:none;">Intentar otro escaneo</button>
</div>

<footer>© 2025 FACAS X. Todos los derechos reservados.</footer>

<audio id="beep-sound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" preload="auto"></audio>
<script src="https://unpkg.com/@zxing/library@latest"></script>
<script>
const fileInput=document.getElementById('fileInput');
const preview=document.getElementById('preview');
const cameraPlaceholder=document.getElementById('cameraPlaceholder');
const scanLine=document.getElementById('scan-line');
const resultado=document.getElementById('resultado');
const photoButton=document.getElementById('photoButton');
const resetButton=document.getElementById('resetButton');
const beep=document.getElementById('beep-sound');

const productos={
  "7709947664513": {nombre:"Volt Energizante 300 ml", tipo:"PET 1", reciclaje:"Lávalo, retira etiqueta y deposítala en contenedor de plásticos reciclables.", descripcion:"Bebida energética popular en envase PET transparente.", impacto:"Reciclar esta botella ahorra suficiente energía para encender un bombillo 6 horas.", calorias:"110 kcal", ingredientes:"Agua, azúcar, cafeína, saborizantes"},
  "7702001111008": {nombre:"Coca-Cola 400 ml", tipo:"PET 1", reciclaje:"Retira la tapa y etiqueta, enjuaga y deposita en contenedor de reciclaje.", descripcion:"Refresco clásico de cola en envase PET.", impacto:"Cada botella reciclada evita emisión de CO₂ y residuos en océanos.", calorias:"140 kcal", ingredientes:"Agua carbonatada, azúcar, colorante, saborizantes"},
  "7702001011001": {nombre:"Postobón Manzana 500 ml", tipo:"PET 1", reciclaje:"Enjuaga y separa de materiales no reciclables.", descripcion:"Refresco de manzana en envase PET.", impacto:"Reciclar ayuda a reducir residuos y consumo de energía.", calorias:"120 kcal", ingredientes:"Agua, azúcar, saborizante de manzana"},
  "7702011011015": {nombre:"Agua Cristal 600 ml", tipo:"PET 1", reciclaje:"Lava la botella, retira etiqueta y aplástala para ahorrar espacio.", descripcion:"Agua mineral embotellada.", impacto:"Reciclar una botella ahorra energía para encender bombillo 6 horas.", calorias:"0 kcal", ingredientes:"Agua mineral"},
  "7709992001008": {nombre:"Pepsi 400 ml", tipo:"PET 1", reciclaje:"Lava la botella y deposítala junto con otros plásticos reciclables.", descripcion:"Refresco de cola en envase PET.", impacto:"Reciclar reduce residuos y CO₂.", calorias:"140 kcal", ingredientes:"Agua carbonatada, azúcar, colorante, saborizantes"}
};

async function escanearImagen(file){
  const reader=new FileReader();
  reader.onload=async function(e){
    preview.src=e.target.result;
    preview.style.display='block';
    cameraPlaceholder.style.display='none';
    scanLine.style.display='block';
    resultado.style.display='block';
    resultado.innerHTML="Escaneando...";
    setTimeout(async ()=>{
      const codeReader=new ZXing.BrowserBarcodeReader();
      try{
        const result=await codeReader.decodeFromImageUrl(preview.src);
        mostrarInfoProducto(result.text);
        beep.play();
      }catch{
        resultado.innerHTML="<p>Producto no reconocido.</p>";
        beep.play();
      }
      scanLine.style.display='none';
      resetButton.style.display='inline-block';
    },1500);
  };
  reader.readAsDataURL(file);
}

function mostrarInfoProducto(codigo){
  if(productos[codigo]){
    const p=productos[codigo];
    resultado.innerHTML=`<h3>${p.nombre}</h3>
      <p><b>Tipo de plástico:</b> ${p.tipo}</p>
      <p><b>Cómo reciclar:</b> ${p.reciclaje}</p>
      <p><b>Descripción:</b> ${p.descripcion}</p>
      <p><b>Impacto ambiental:</b> ${p.impacto}</p>
      <p><b>Calorías:</b> ${p.calorias}</p>
      <p><b>Ingredientes:</b> ${p.ingredientes}</p>`;
  } else {
    resultado.innerHTML="<p>Producto no reconocido.</p>";
    beep.play();
  }
}

fileInput.addEventListener('change',e=>{if(e.target.files.length>0) escanearImagen(e.target.files[0]);});

photoButton.addEventListener('click',async ()=>{
  const videoContainer=document.createElement('div');
  const video=document.createElement('video');
  video.style.width='100%';
  videoContainer.appendChild(video);
  document.querySelector('.container').appendChild(videoContainer);

  const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});
  video.srcObject=stream;
  video.play();

  const snapButton=document.createElement('button');
  snapButton.innerText="Capturar Foto";
  snapButton.className="custom-button";
  videoContainer.appendChild(snapButton);

  snapButton.addEventListener('click',()=>{
    const canvas=document.createElement('canvas');
    canvas.width=video.videoWidth;
    canvas.height=video.videoHeight;
    canvas.getContext('2d').drawImage(video,0,0);
    stream.getTracks().forEach(track=>track.stop());
    videoContainer.remove();
    canvas.toBlob(blob=>escanearImagen(blob),'image/jpeg');
  });
});

resetButton.addEventListener('click',()=>{
  resultado.style.display='none';
  preview.style.display='none';
  scanLine.style.display='none';
  cameraPlaceholder.style.display='block';
  resetButton.style.display='none';
});

const sidebar=document.getElementById("mySidebar");
const hamburger=document.getElementById("hamburger");
hamburger.addEventListener("click",()=>{hamburger.classList.toggle("active"); sidebar.classList.toggle("active");});
</script>
</body>
</html>
